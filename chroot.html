<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.20" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>Chroot</title><meta name="description" content="「 须臾水面明月出，沧江万顷琉璃寒 」">
    <link rel="stylesheet" href="/assets/css/styles.3c4b45cd.css">
    <link rel="preload" href="/assets/js/runtime~app.1d58c722.js" as="script"><link rel="preload" href="/assets/css/styles.3c4b45cd.css" as="style"><link rel="preload" href="/assets/js/397.5fa13d91.js" as="script"><link rel="preload" href="/assets/js/app.0b056ad8.js" as="script">
    <link rel="prefetch" href="/assets/js/index.html.eb9a2b52.js" as="script"><link rel="prefetch" href="/assets/js/Build.html.05f05ce4.js" as="script"><link rel="prefetch" href="/assets/js/chroot.html.38ed6c1f.js" as="script"><link rel="prefetch" href="/assets/js/rootfs.html.2d45ad69.js" as="script"><link rel="prefetch" href="/assets/js/404.html.45cb4f27.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><!----></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Ruri"><!--[--><!--[--><!--]--><!--]-->Ruri<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Build.html" aria-label="Build"><!--[--><!--[--><!--]--><!--]-->Build<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Ruri"><!--[--><!--[--><!--]--><!--]-->Ruri<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Build.html" aria-label="Build"><!--[--><!--[--><!--]--><!--]-->Build<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Chroot <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="chroot" tabindex="-1"><a class="header-anchor" href="#chroot"><span>Chroot</span></a></h1><p>Chroot stands for &quot;change root.&quot; It was introduced in Unix systems to change the apparent root directory for a running process and its children. Unlike Windows, which uses drive letters like C:\ or D:, Linux has a single root directory <code>/</code>, and everything is mounted beneath it. When a process accesses an absolute path, it starts from <code>/</code>.</p><p>With chroot, you can change the root directory for a process, restricting its view and access to only the files and directories under the new root. This isolation is a key feature of Linux containers.</p><p>For example, consider the program <code>cat</code>, which is linked to several libraries:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">linux-vdso.so.1 (0x0000ffffaba1f000)</span>
<span class="line">libc.so.6 =&gt; /lib/aarch64-linux-gnu/libc.so.6 (0x0000ffffab7e0000)</span>
<span class="line">/lib/ld-linux-aarch64.so.1 (0x0000ffffab9d0000)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(*vdso is a virtual dynamic shared object provided by the kernel.)</p><p>If you run <code>cat</code> on the host system, it loads libraries from <code>/lib/aarch64-linux-gnu/libc.so.6</code> and <code>/lib/ld-linux-aarch64.so.1</code>. If these libraries don&#39;t match what <code>cat</code> expects, it may fail to run. However, in a chroot environment, <code>cat</code> only sees and loads libraries from the new root directory, unaffected by the host&#39;s libraries.</p><p>This is why you can run Debian, Alpine, or Arch Linux... (and so on) containers on hosts with different distributions, and even run Linux containers on Android devices. In essence, chroot makes the entire root filesystem act like a &quot;statically linked&quot; environment, ensuring compatibility and isolation.</p><h1 id="the-chroot-system-call" tabindex="-1"><a class="header-anchor" href="#the-chroot-system-call"><span>The chroot system call</span></a></h1><p>The chroot() system call changes the root directory of the calling process to a specified path. It was designed to run only with superuser privileges(was it really more secure?). But nowadays, you can also use it in user namespaces, which allow unprivileged users to create isolated environments.<br> It&#39;s very simple to use, just like this:</p><div class="language-c line-numbers-mode" data-highlighter="prismjs" data-ext="c"><pre><code><span class="line"><span class="token comment">// Include necessary headers.</span></span>
<span class="line"><span class="token function">chroot</span><span class="token punctuation">(</span><span class="token string">&quot;/new_root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;/bin/bash&quot;</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">execv</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated:: </span><time class="meta-item-info" datetime="2025-09-13T05:57:27.000Z" data-allow-mismatch>9/13/25, 5:57 AM</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: moe-hacker@outlook.com">Moe-hacker</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: siyueba73@gmail.com">Nyawww</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.1d58c722.js" defer></script><script src="/assets/js/397.5fa13d91.js" defer></script><script src="/assets/js/app.0b056ad8.js" defer></script>
  </body>
</html>
